{% load i18n %}
{% with show_contact=show_contact|default:True %}
{% with show_profile_link=show_profile_link|default:False %}
{% with topics=topic_areas|default:representative.topic_areas.all %}
{% with focus_topics=representative.focus_topics %}
<div class="d-flex align-items-start gap-3 representative-card">
    {% if representative.photo_url %}
        <img src="{{ representative.photo_url }}"
             alt="{{ representative.full_name }}"
             class="img-fluid rounded shadow-sm"
             style="width: 110px; max-height: 140px; object-fit: cover;">
    {% endif %}
    <div class="flex-grow-1">
        <h5 class="mb-1">{{ representative.full_name }}</h5>
        <p class="mb-1 text-muted small">
            {% if representative.party %}
                <span class="badge bg-secondary me-1">{{ representative.party }}</span>
            {% endif %}
            {{ representative.parliament.name }}
            {% if constituency %}
                · {% trans "Wahlkreis" %}: {{ constituency.name }}
            {% elif representative.primary_constituency %}
                · {% trans "Wahlkreis" %}: {{ representative.primary_constituency.name }}
            {% endif %}
        </p>
        <p class="mb-1 small text-muted">
            {% trans "Mandate" %}: {{ representative.get_election_mode_display }}
            {% if representative.term_start %}
                · {% trans "Since" %} {{ representative.term_start|date:"SHORT_DATE_FORMAT" }}
            {% endif %}
        </p>
        {% if focus_topics %}
            <p class="mb-2 small">
                <strong>{% trans "Focus" %} ({% trans "self-declared" %}):</strong>
                {% for topic in focus_topics|slice:":3" %}
                    <span class="badge bg-light text-dark border me-1">{{ topic }}</span>
                {% endfor %}
                {% if focus_topics|length > 3 %}
                    <span class="text-muted">+{{ focus_topics|length|add:'-3' }}</span>
                {% endif %}
            </p>
        {% endif %}
        {% if topics %}
            <p class="mb-2 small">
                <strong>{% trans "Committees" %}:</strong>
                {% for topic in topics|slice:":3" %}
                    <span class="badge bg-info text-dark border me-1">{{ topic.name }}</span>
                {% endfor %}
                {% if topics|length > 3 %}
                    <span class="text-muted">+{{ topics|length|add:'-3' }}</span>
                {% endif %}
            </p>
        {% endif %}
        {% if show_contact %}
            <p class="mb-2 small">
                {% if representative.email %}
                    <strong>{% trans "Email" %}:</strong> <a href="mailto:{{ representative.email }}">{{ representative.email }}</a><br>
                {% endif %}
                {% if representative.website %}
                    <strong>{% trans "Website" %}:</strong> <a href="{{ representative.website }}" target="_blank" rel="noopener">{{ representative.website }}</a>
                {% endif %}
            </p>
        {% endif %}
        {% if show_profile_link %}
            <a href="{% url 'representative_detail' representative.id %}" class="small">
                {% trans "View profile" %} →
            </a>
        {% endif %}
    </div>
</div>
{% endwith %}
{% endwith %}
{% endwith %}
{% endwith %}
